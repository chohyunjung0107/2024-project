(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[709],{3442:function(e,t,n){Promise.resolve().then(n.bind(n,1663))},1663:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var s=n(9673),c=n(7463),o=n(1513),i=n(4343),a=n.n(i);function r(){return(0,s.jsxs)("div",{className:"jsx-cc04d918e829cd52 loading",children:[(0,s.jsx)("p",{className:"jsx-cc04d918e829cd52",children:"로딩..."}),(0,s.jsx)(a(),{id:"cc04d918e829cd52",children:".loading.jsx-cc04d918e829cd52{position:fixed;top:0;left:0;right:0;bottom:0;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;background-color:rgba(255,255,255,.8);z-index:1000}"})]})}function l(){let[e,t]=(0,c.useState)([]),[n,i]=(0,c.useState)(null),[a,l]=(0,c.useState)({isName:"",country:""}),[d,u]=(0,c.useState)(!1),[h,x]=(0,c.useState)(""),[m,f]=(0,c.useState)([]),[p,j]=(0,c.useState)(null),[g,y]=(0,c.useState)(0),k=async()=>{u(!0);try{let e=await fetch("/api/users"),n=await e.json();t(n)}catch(e){console.error("error:",e)}finally{u(!1)}},b=async()=>{try{let e=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a.isName})});if(!e.ok)throw Error("Network response was not ok");let t=await e.json();"Data updated successfully"===t.message&&k(),console.log("post결과",t)}catch(e){i(e.message)}};(0,c.useEffect)(()=>{let e=(0,o.ZP)("http://localhost:5000",{path:"/socket.io"});return e.on("connect",()=>{console.log("Connected to server")}),e.on("chat msg",e=>{f(t=>[...t,e])}),e.on("news",e=>{console.log("plus num",e),y(e)}),j(e),()=>{e.disconnect()}},[]);let w=()=>{p&&h.trim()&&(p.emit("chat msg",h),x(""))};return(0,c.useEffect)(()=>{k()},[]),(0,c.useEffect)(()=>{console.log("testNum",g)},[g]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("h1",{children:[(0,s.jsx)("input",{name:"isName",value:a.isName,onChange:e=>{let{name:t,value:n}=e.target;l({...a,[t]:n})},onKeyDown:e=>{"Enter"===e.key&&b()}}),(0,s.jsx)("button",{onClick:b,children:"수정"}),!0===d?(0,s.jsx)(r,{}):e&&e.map(e=>(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{children:["name : ",e.name]}),(0,s.jsxs)("div",{children:["country : ",e.country]})]},e.id))]}),(0,s.jsx)("hr",{}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{children:"Socket.IO Chat"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{type:"text",value:h,onChange:e=>x(e.target.value),onKeyDown:e=>{"Enter"===e.key&&w()}}),(0,s.jsx)("button",{onClick:w,children:"Send"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{children:["Chat Messages / ",g]}),m.map((e,t)=>(0,s.jsx)("p",{children:e},t))]})]})]})}}},function(e){e.O(0,[861,997,19,744],function(){return e(e.s=3442)}),_N_E=e.O()}]);